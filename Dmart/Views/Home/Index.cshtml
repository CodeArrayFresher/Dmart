@model IEnumerable<Dmart.Models.OrderDetail>
@model IEnumerable<Dmart.Models.Customer>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
@{
    ViewBag.Title = "Index";
}

<h2>Order Details</h2>

@*<p>
        @Html.ActionLink("Create New", "Create")
    </p>*@
<table class="table">
    <tr>
        <th>
            <button class="btn btn-dark btnTest">Expand All</button>
        </th>
        <th>
            Order Id
        </th>
        <th>
            @Html.DisplayNameFor(model => model.OrderDate)
        </th>
        <th>
            Customer Name
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Quanity)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.TotalAmount)
        </th>

    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @*<div class="clkall" >
                        <span class="glyphicon glyphicon-plus" id="@("span"+item.Id)"></span>
                        <div class="nest" style="display:none">
                            <table class="table table-dark" id="tbl">
                                <tr>
                                    <th>Product ID</th>
                                    <th>Prdouct Name</th>
                                    <th>Quantity</th>
                                    <th>Unit_price</th>
                                    <th>Total Amount</th>
                                </tr>

                                <tr class="trTble">
                                    <td> @Html.DisplayFor(modelItem => item.ProductId)</td>
                                    <td> @Html.DisplayFor(modelItem => item.ProductName)</td>
                                    <td> @Html.DisplayFor(modelItem => item.Quanity)</td>
                                    <td> @Html.DisplayFor(modelItem => item.UnitPrice)</td>
                                    <td> @Html.DisplayFor(modelItem => item.TotalAmount)</td>
                                </tr>

                            </table>
                            @foreach(var product in Model.Where(x=> x.Id == item.Id))
                    {

                    }*@
                @*</div>
                    </div>*@
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Id)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.OrderDate)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CustomerName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Quanity)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.TotalAmount)
            </td>
            @*<td>
                    @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id=item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id=item.Id })
                </td>*@
        </tr>
    }

</table>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">
    //Assign Click event to Plus Image.

    var model = @Html.Raw(Json.Encode(Model));
    console.log(model);

        $("body").on("click", "span[class *='glyphicon glyphicon-plus']", function () {
            debugger;
            $(this).closest("tr").after("<tr><td></td><td colspan = '999'>" + $(this).next().html() + "</td></tr>");

            $(this).attr("class", "glyphicon glyphicon-minus");
        });

    $("body").on("click", "span[class *='glyphicon glyphicon-minus']", function () {
        $(this).attr("class", "glyphicon glyphicon-plus");
        $(this).closest("tr").next().remove();
    });

    //$(".clkall").on('click', "span", function () {
    //    alert("hello");
    //});
    //$("button").click(function () {
    //    $("span[class *= 'glyphicon glyphicon-plus']").closest("tr").after("<tr><td></td><td colspan = '999'>" + $("span[class *= 'glyphicon glyphicon-plus']").next().html() + "</td></tr>");

    //});
    $("button").click(function () {
       @* debugger;

        var TrList = $("#tbl").find("tr[class*='trTble']");
        console.log(TrList);
        TrList.each(function (i, e) {
            $(e).closest("tr").after("<tr><td></td><td colspan = '999'>" + $(e).next().html() + "</td></tr>");
            $(e).attr("class", "glyphicon glyphicon-minus");
        });*@

        $.each(model, function (index, item) {

            $("#span" + item.Id).trigger("click");
        });
    });
        //$(".nest").toggle(100, function () {
        //    $("span[class *='glyphicon glyphicon-plus'").attr("class", "glyphicon glyphicon-minus");

        //});


        //$("span[class *= 'glyphicon glyphicon-plus']").closest("tr").after("<tr><td></td><td colspan = '999'>" + $("span[class *= 'glyphicon glyphicon-plus']").next().html() + "</td></tr>");

</script>