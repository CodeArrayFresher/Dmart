@model Dmart.Models.OrderModel
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

<style>
    #Tab, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }
 #Tab th{
     background-color: darkgray;
     color:black
 }
</style>
<body>

    <h2>Order List</h2>

    <button id="expandall" type="button" class="btn btn-dark"> Expand All </button>

    <button id="collapseall" type="button" style="display:none;"> Collapse All </button>
    <br /> <br />
           <table class="table table-bordered table-hover text-center" id="Tab" style="border: 1px solid #A0A0A0">
               <tr class="text-center">
                   <th></th>
                   <th class="text-center">
                       @Html.DisplayNameFor(model => model.OrderId)
                   </th>
                   <th class="text-center">
                       @Html.DisplayNameFor(model => model.OrderDate)
                   </th>
                   <th class="text-center">
                       @Html.DisplayNameFor(model => model.CustomerName)
                   </th>
                   <th class="text-center">
                       Edit
                   </th>
                   <th class="text-center">
                       View Invoice
                   </th>
               </tr>
               @foreach (var item in Model.OrderList)
               {
                   <tr class="trlist">
                       <td>
                           <img src="~/Content/plus.png" height="20" width="20" onclick="GetProduct(this)" />
                       </td>
                       <td class="OrderID">
                           @Html.DisplayFor(modelItem => item.OrderId)
                       </td>
                       <td>
                           @Html.DisplayFor(modelItem => item.OrderDate)
                       </td>
                       <td>
                           @Html.DisplayFor(modelItem => item.CustomerName)
                       </td>
                       <td>
                           <button type="button">@Html.ActionLink("Edit", "Edit", new { id = item.OrderId })</button>
                       </td>
                       <td>
                           <button type="button">@Html.ActionLink("Invoice", "Invoice", new { id = item.OrderId })</button>
                       </td>
                   </tr>
                   <tr class="productTable">
                       
                   </tr>
                   @*<tr class="trlist productTable">
                    <td colspan='999'>
                @Html.Partial("/Views/Home/_IndexProductList.cshtml");
                       </td>
            </tr>*@

               }

           </table>

    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script type="text/javascript">

        $("body").on("click", "img[src*='plus.png']", function () {

            $(this).parent().parent().next('.productTable').show();
            $(this).attr("src", "/Content/minus.png");
        });

        $("body").on("click", "img[src*='minus.png']", function () {
            $(this).attr("src", "/Content/plus.png");
            $(this).parent().parent().next('.productTable').hide();
        });



        function GetProduct(id) {
            //console.log(id)
            var ids = $(id).parent().parent().find('.OrderID')[0].innerText;
            var ids2 = parseInt(ids);
            //var html = `<tr class="trlist productTable"><td colspan = '999'></td></tr>`
            //console.log(html);
            $.ajax({
                type: "get",
                url: '/Home/_IndexProductList',
                data: { 'id': ids2 },
                success: function (x) {
                    //console.log();
                   //var a = HtmlEncode(x)
                    $(id).parent().parent().next().append(x);
                    //$('.productTable').append(x);
                },
                error: function () {
                    alert("dynamic content not found");
                },
            })
            //console.log(typeof(ids2));

        }





        $(document).on('click', '#expandall', function () {

            $(".trlist").each(function (i, e) {

                if ($(".productTable").is(":hidden")) {
                    $(e).find("img").attr("src", "/Content/minus.png");
                } else {
                    $(e).find("img").attr("src", "/Content/plus.png");
                }

                $(e).next('.productTable').toggle(500, "linear");





            });
        });










    </script>


</body>